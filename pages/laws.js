import React, { useState, useEffect } from "react";
import Head from "next/head";

import axios from "axios";
import { SiteAPI } from "../config";

import LawsPage from "./components/LawsPage";

export default function Laws({ leyNormasTipos }) {
  console.log(leyNormasTipos);
  const [treeData, setTreeData] = useState(null);
  const isArray = Array.isArray(leyNormasTipos);

  useEffect(() => {
    setTreeData(leyNormasTipos);
  }, []);

  /*
  if (isArray) {
    nodes = leyNormasTipos;
  } else {
    nodes = [
      {
        value: leyNormasTipos.COD_NORMA,
        label: leyNormasTipos.DES_DESCRIPCION,
        children: [
          {
            value: "Employee Evaluations.zip",
            label: "Employee Evaluations.zip",
            icon: <i className="far fa-file-archive icon-color" />,
            children: [
              {
                value: "A",
                label: "A",
                icon: <i className="far fa-file-archive icon-color" />,
              },
              {
                value: "B",
                label: "B",
                icon: <i className="far fa-file-pdf icon-color" />,
              },
              {
                value: "C",
                label: "C",
                icon: <i className="far fa-file-alt icon-color" />,
              },
            ],
          },
          {
            value: "Expense Report.pdf",
            label: "Expense Report.pdf",
            icon: <i className="far fa-file-pdf icon-color" />,
          },
          {
            value: "notes.txt",
            label: "notes.txt",
            icon: <i className="far fa-file-alt icon-color" />,
          },
        ],
      },
    ];
  }
  */

  return (
    <>
      <Head>
        <title>Laws App</title>
        <meta name="description" content="Generated by create next app" />
        <link rel="icon" href="/favicon.ico" />
      </Head>

      {treeData && <LawsPage nodes={treeData} />}
    </>
  );
}

export const getStaticProps = async () => {
  const leyNormasTipos = await axios.get(`${SiteAPI.leyNormas}/type/2`);

  return {
    props: {
      leyNormasTipos: leyNormasTipos.data,
      mainLayout: true,
    },
    revalidate: 1,
  };
};
